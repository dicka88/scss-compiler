<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>
			SCSS compiler
		</title>
		<link rel="stylesheet" href="/css/tailwind.css" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/a11y-dark.min.css" />
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
		<style>
			#css-editor,
			#scss-editor {
				height: 100% !important;
				width: 100% !important;
				font-size: 17px;
			}
			.fullscreen {
				top: 0;
				bottom: 0;
				left: 0;
				right: 0;
			}
			.convert {
				right: 0;
				left: 0;
				top: 0;
				bottom: 0;
				position: absolute;
				margin: auto;
				width: 50px;
				height: 50px;
				z-index: 5;
			}
			.convert > .convert-button {
				border-radius: 50px;
				background-color: rgb(45, 112, 214);
				/* margin-top: -10em; */
				display: flex;
				padding: 1em;
				border: none;
				width: 50px;
				height: 50px;
				transition: cubic-bezier(0.55, 0.085, 0.68, 0.53) 0.1s;
			}
			.convert-button:hover {
				background-color: rgb(26, 98, 161);
			}
			.convert-button:active {
				transform: scale(0.9);
			}
			.ace_scrollbar {
				display: none !important;
			}
			.material-icons {
				font-size: 20px;
				vertical-align: middle;
			}
		</style>
	</head>
	<body>
		<header>
			<div class="flex bg-black justify-center text-white">
				<span>Black lives matter</span>
			</div>
			<nav class="flex items-center justify-between flex-wrap bg-teal-700 p-6">
				<div class="flex items-center flex-shrink-0 text-white mr-6">
					<svg class="fill-current h-8 w-8 mr-2" width="54" height="54" viewBox="0 0 54 54" xmlns="http://www.w3.org/2000/svg">
						<path
							d="M13.5 22.1c1.8-7.2 6.3-10.8 13.5-10.8 10.8 0 12.15 8.1 17.55 9.45 3.6.9 6.75-.45 9.45-4.05-1.8 7.2-6.3 10.8-13.5 10.8-10.8 0-12.15-8.1-17.55-9.45-3.6-.9-6.75.45-9.45 4.05zM0 38.3c1.8-7.2 6.3-10.8 13.5-10.8 10.8 0 12.15 8.1 17.55 9.45 3.6.9 6.75-.45 9.45-4.05-1.8 7.2-6.3 10.8-13.5 10.8-10.8 0-12.15-8.1-17.55-9.45-3.6-.9-6.75.45-9.45 4.05z"
						/>
					</svg>
					<span class="font-semibold text-xl tracking-tight">SCSS Compiler</span>
				</div>
				<div class="block lg:hidden">
					<button class="flex items-center px-3 py-2 border rounded text-teal-200 border-teal-400 hover:text-white hover:border-white">
						<svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
							<title>
								Menu
							</title>
							<path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" />
						</svg>
					</button>
				</div>
				<div class="w-full sm:hidden flex-grow lg:flex lg:items-center lg:w-auto">
					<div class="text-sm lg:flex-grow">
						<a href="#responsive-header" class="block mt-4 lg:inline-block lg:mt-0 text-teal-200 hover:text-white mr-4">
							SCSS-CSS
						</a>
						<a href="#responsive-header" class="block mt-4 lg:inline-block lg:mt-0 text-teal-200 hover:text-white mr-4">
							CSS-SCSS
						</a>
						<a href="#responsive-header" class="block mt-4 lg:inline-block lg:mt-0 text-teal-200 hover:text-white">
							SASS-CSS
						</a>
					</div>
					<div>
						<a href="#" class="inline-block text-sm px-4 py-2 leading-none border rounded text-white border-white hover:border-transparent hover:text-teal-500 hover:bg-white mt-4 lg:mt-0">
							<i class="fa fa-github"></i>
							<span>Github</span>
						</a>
						<a href="#" class="text-white ml-5">
							<i class="material-icons">favorite_border</i>
						</a>
					</div>
				</div>
			</nav>
		</header>
		<main>
			<div class="flex mb-4" style="position: relative;">
				<div class="w-1/2 mr-1 bg-gray-200 h-screen scss-wrapper">
					<div class="flex px-3 py-1 justify-between bg-white">
						<div style="margin: auto 0;">
							<img src="./images/sass-icon.svg" style="height: 20px;" alt="" />
						</div>
						<div>
							<button title="download" onclick="scssSaveFile()"><i class="material-icons">file_download</i></button>
							<button title="copy" data-clipboard-target="#scss-editor" onclick="scssCopyClipboard()"><i class="material-icons">content_copy</i></button>
							<button title="clear" onclick="scssClear()"><i class="material-icons">clear</i></button>
							<button title="beautify scss" onclick="scssbeautify()"><i class="material-icons">format_paint</i></button>
							<button title="fullscreen" onclick="scssFullscreen()"><i class="material-icons">fullscreen</i></button>
						</div>
					</div>
					<div id="scss-editor" class="fullscreen"></div>
				</div>
				<div class="w-1/2 ml-1 bg-gray-900 h-screen css-wrapper">
					<div class="flex px-3 py-1 justify-between bg-white">
						<div style="margin: auto 0;" class="flex justify-between">
							<img src="./images/css3-icon.svg" style="height: 24px;" alt="" />
							<span class="pl-2">Result</span>
						</div>
						<div>
							<button title="download"><i class="material-icons">file_download</i></button>
							<button title="copy"><i class="material-icons">content_copy</i></button>
							<button title="fullscreen" onclick="cssFullscreen()"><i class="material-icons">fullscreen</i></button>
						</div>
					</div>
					<div id="css-editor"></div>
				</div>
				<div class="convert">
					<button class="convert-button text-white">
						<i class="material-icons">play_arrow</i>
					</button>
				</div>
			</div>
		</main>
		<footer>
			<div class="w-full bg-teal-800 p-8 pt-12 pb-24 mt-10 text-white">
				<div class="sm:flex mb-4">
					<div class="sm:w-1/4 h-auto">
						<div class="text-orange mb-2">Orange</div>
						<ul class="list-reset leading-normal">
							<li class="hover:text-orange text-grey-darker">One</li>
							<li class="hover:text-orange text-grey-darker">Two</li>
							<li class="hover:text-orange text-grey-darker">Three</li>
							<li class="hover:text-orange text-grey-darker">Four</li>
						</ul>
					</div>
					<div class="sm:w-1/4 h-auto sm:mt-0 mt-8">
						<div class="text-blue mb-2">Blue</div>
						<ul class="list-reset leading-normal">
							<li class="hover:text-blue text-grey-darker">One</li>
							<li class="hover:text-blue text-grey-darker">Two</li>
							<li class="hover:text-blue text-grey-darker">Three</li>
						</ul>

						<div class="text-blue-light mb-2 mt-4">Blue-light</div>
						<ul class="list-reset leading-normal">
							<li class="hover:text-blue-light text-grey-darker">One</li>
							<li class="hover:text-blue-light text-grey-darker">Two</li>
							<li class="hover:text-blue-light text-grey-darker">Three</li>
						</ul>
					</div>
					<div class="sm:w-1/4 h-auto sm:mt-0 mt-8">
						<div class="text-green-dark mb-2">Green-dark</div>
						<ul class="list-reset leading-normal">
							<li class="hover:text-green-dark text-grey-darker">One</li>
							<li class="hover:text-green-dark text-grey-darker">Two</li>
							<li class="hover:text-green-dark text-grey-darker">Three</li>
						</ul>

						<div class="text-green-light mb-2 mt-4">Green-light</div>
						<ul class="list-reset leading-normal">
							<li class="hover:text-green-light text-grey-darker">One</li>
							<li class="hover:text-green-light text-grey-darker">Two</li>
							<li class="hover:text-green-light text-grey-darker">Three</li>
						</ul>
					</div>
					<div class="sm:w-1/2 sm:mt-0 mt-8 h-auto">
						<div class="text-red-light mb-2">Newsletter</div>
						<p class="text-grey-darker leading-normal">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Commodi, consectetur.</p>
						<div class="mt-4 flex">
							<input type="text" class="p-2 border border-grey-light round text-grey-dark text-sm h-auto" placeholder="Your email address" />
							<button class="bg-orange text-white rounded-sm h-auto text-xs p-3">Subscribe</button>
						</div>
					</div>
				</div>
			</div>
			<div class="flex bg-gray-800 pt-1 pb-4 justify-center text-4md text-white">
				<span>don't mind other people, just do your will</span>
			</div>
		</footer>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ext-language_tools.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ext-beautify.js"></script>
		<script src="./js/clipboard.min.js"></script>
		<script>
			ace.require("ace/ext/language_tools");

			var scsseditor = ace.edit("scss-editor");
			scsseditor.setTheme("ace/theme/monokai");
			scsseditor.session.setMode("ace/mode/scss");
			scsseditor.setOptions({
				enableBasicAutocompletion: false,
				enableSnippets: false,
				enableLiveAutocompletion: true,
				tabSize: 2,
				showPrintMargin: false,
			});

			/**
			 * set value for demo
			 */
			scsseditor.setValue(
				`
				.code {
					color: red;
					&:hover {
						transform: scale(1.4)
					}
				}
			`,
				1
			);

			// for beautify
			var beautify = ace.require("ace/ext/beautify");
			function scssbeautify() {
				beautify.beautify(scsseditor.session);
			}

			var csseditor = ace.edit("css-editor");
			csseditor.setReadOnly(true);
			csseditor.setTheme("ace/theme/monokai");
			csseditor.session.setMode("ace/mode/css");
		</script>
		<script>
			document.addEventListener("DOMContentLoaded", function () {
				document.querySelector(".convert-button").addEventListener("click", fetchCss);
			});
		</script>
		<script>
			// listener
			let debFetch = debounce(fetchCss, 1500);
			scsseditor.session.on("change", function (delta) {
				debFetch();
			});

			async function fetchCss() {
				const stringScss = scsseditor.getValue();
				if (!stringScss) return;

				const data = await fetch("/api/scss-css", {
					method: "POST",
					headers: {
						"Content-Type": "application/json",
					},
					body: JSON.stringify({
						string: stringScss,
					}),
				});
				if (!data) return;
				const html = await data.text();
				console.log(html);

				csseditor.setValue(html, 1);
			}

			function debounce(callback, time) {
				var timeout;
				return function () {
					clearTimeout(timeout);

					timeout = setTimeout(callback, time);
				};
			}

			// helper
			// copy to clipboard from string
			const copyClipboard = (string) => {
				var el = document.createElement("textarea");
				el.style.display = "hidden";
				el.value = string;
				document.body.appendChild(el);
				el.select();
				document.execCommand("copy");
				document.body.removeChild(el);
			};

			// save file
			const saveFile = (function () {
				var a = document.createElement("a");
				document.body.appendChild(a);
				a.style = "display: none";
				return function (data, fileName) {
					// const string = Strin.toString
					var blob = new Blob([data], { type: "octet/stream" }),
						url = window.URL.createObjectURL(blob);
					a.href = url;
					a.download = fileName;
					a.click();
					window.URL.revokeObjectURL(url);
				};
			})();

			// scss toolbar
			const scssFullscreen = () => (!document.fullscreen ? document.querySelector(".scss-wrapper").requestFullscreen() : document.exitFullscreen());
			const scssCopyClipboard = () => copyClipboard(scsseditor.getValue());
			const scssSaveFile = () => saveFile(scsseditor.getValue(), "scssdownload.scss");

			const cssFullscreen = () => (!document.fullscreen ? document.querySelector(".css-wrapper").requestFullscreen() : document.exitFullscreen());
		</script>
	</body>
</html>
